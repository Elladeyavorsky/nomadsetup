---
import Layout from '../layouts/Layout.astro';
import CtaButton from '../components/CtaButton.astro';
import ArticleCard from '../components/ArticleCard.astro';
import siteData from '../content/site.json';
import pagesData from '../content/pages.json';
import articlesData from '../content/articles.json';

// Get latest 6 articles
const latestArticles = articlesData
  .sort((a, b) => new Date(b.publishedDate).getTime() - new Date(a.publishedDate).getTime())
  .slice(0, 6);

const { hero, essentials } = pagesData.home;
---

<Layout title="Accueil">
  <div class="full-bleed-hero">
    <img src="/hero.png" alt="Light Nomad Landscape" class="hero-bg" />
    <div class="hero-overlay"></div>
    <section class="hero">
      <h1>{siteData.tagline}</h1>
      <p class="subtitle">{siteData.description}</p>
      <div class="cta-group">
        {hero.ctas.map(cta => (
           <CtaButton href={cta.url} label={cta.label} />
        ))}
      </div>
    </section>
  </div>

  <section id="essentials" class="section">
    <h2>{essentials.title}</h2>
    <div class="essentials-grid">
      {essentials.items.map(item => (
        <a href={item.url} class="essential-link card">
          {item.label} &rarr;
        </a>
      ))}
    </div>
  </section>

  <section class="section">
    <h2>Derniers Articles</h2>
    <div class="articles-grid grid-2">
      {latestArticles.map(article => (
        <ArticleCard
          title={article.title}
          excerpt={article.excerpt}
          url={`/${article.section}/${article.slug}`}
          date={article.publishedDate}
          section={article.section}
        />
      ))}
    </div>
  </section>
</Layout>

<style>
  .full-bleed-hero {
    width: 100vw;
    margin-left: calc(50% - 50vw);
    position: relative;
    min-height: 60vh;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 3rem;
    overflow: hidden;
  }
  .hero-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: -2;
  }
  .hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
    z-index: -1;
  }
  .hero {
    text-align: center;
    padding: 4rem 1rem;
    max-width: var(--container-width);
    width: 100%;
    color: white;
  }
  .hero h1 {
    color: white;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }
  .subtitle {
    font-size: 1.25rem;
    color: #f0f0f0;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    margin: 1rem auto 3rem;
  }
  .cta-group {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }
  .section {
    margin-top: 6rem;
  }
  .essentials-grid {
    display: grid;
    gap: 1.5rem;
    margin-top: 2rem;
  }
  .essential-link {
    display: block;
    text-align: center;
    font-weight: 600;
    font-size: 1.1rem;
    border: 1px solid var(--color-border);
  }
  .essential-link:hover {
    background: #fafafa;
  }
  @media(min-width: 640px) {
    .essentials-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }
</style>
