---
import Layout from '../layouts/Layout.astro';
import CtaButton from '../components/CtaButton.astro';
import ArticleCard from '../components/ArticleCard.astro';
import siteData from '../content/site.json';
import pagesData from '../content/pages.json';
import articlesData from '../content/articles.json';

// Get latest 6 articles
const latestArticles = articlesData
  .sort((a, b) => new Date(b.publishedDate).getTime() - new Date(a.publishedDate).getTime())
  .slice(0, 6);

const { hero, essentials } = pagesData.home;
---

<Layout title="Accueil">
  <section class="hero">
    <h1>{siteData.tagline}</h1>
    <p class="subtitle">{siteData.description}</p>
    <div class="cta-group">
      {hero.ctas.map(cta => (
         <CtaButton href={cta.url} label={cta.label} />
      ))}
    </div>
  </section>

  <section id="essentials" class="section">
    <h2>{essentials.title}</h2>
    <div class="essentials-grid">
      {essentials.items.map(item => (
        <a href={item.url} class="essential-link card">
          {item.label} &rarr;
        </a>
      ))}
    </div>
  </section>

  <section class="section">
    <h2>Derniers Articles</h2>
    <div class="articles-grid grid-2">
      {latestArticles.map(article => (
        <ArticleCard
          title={article.title}
          excerpt={article.excerpt}
          url={`/${article.section}/${article.slug}`}
          date={article.publishedDate}
          section={article.section}
        />
      ))}
    </div>
  </section>
</Layout>

<style>
  .hero {
    text-align: center;
    padding: 4rem 0;
  }
  .subtitle {
    font-size: 1.25rem;
    color: var(--color-text-light);
    margin: 1rem auto 3rem;
  }
  .cta-group {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }
  .section {
    margin-top: 6rem;
  }
  .essentials-grid {
    display: grid;
    gap: 1.5rem;
    margin-top: 2rem;
  }
  .essential-link {
    display: block;
    text-align: center;
    font-weight: 600;
    font-size: 1.1rem;
    border: 1px solid var(--color-border);
  }
  .essential-link:hover {
    background: #fafafa;
  }
  @media(min-width: 640px) {
    .essentials-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }
</style>
